<?xml version="1.0" encoding="utf-8"?>
<mdscript name="ResearchBlueprintsMod" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
  <cues>
    <cue name="DiablogOptions" instantiate="true">
      <conditions>
        <event_conversation_started conversation="default" actor="md.$PersistentCharacters.$BosoTa"/>
      </conditions>
      <actions>
        <do_if value="@md.ExtendedConversationMenu.Main.exists">
          <set_value name="md.ExtendedConversationMenu.Main.$convOptions.$researchBlueprintsMod" exact="table[ $signalCue = RBM_Main, $params = [] ]"/>
        </do_if>
        <do_else>
          <signal_cue_instantly cue="RBM_Main"/>
        </do_else>
      </actions>
    </cue>
    <cue name="RBM_Main" instantiate="true">
      <conditions>
        <check_any>
          <event_cue_signalled />
          <check_all>
            <event_conversation_returned_to_section section="default" actor="md.$PersistentCharacters.$BosoTa"/>
            <check_value value="@md.ExtendedConversationMenu.Main.exists" negate="true"/>
          </check_all>
        </check_any>
      </conditions>
      <actions>
        <add_player_choice_sub text="'%s %s'.[{1001,97}, {1001,7400}]" section="RBM_Main_Entry" comment="Blueprints research"/>
        <do_if value="@md.ExtendedConversationMenu.Main.exists" negate="true">
          <add_player_choice_return text="{1002,2}" position="bottom_right" comment="Goodbye" returnparam="[true, event.param2]" />
        </do_if>
      </actions>
    </cue>
    <cue name="RBM_Main_Entry_handler" instantiate="true">
      <conditions>
        <check_any>
          <event_conversation_next_section section="RBM_Main_Entry"/>
          <event_conversation_returned_to_section section="RBM_Main_Entry"/>
        </check_any>
      </conditions>
      <actions>
        <add_player_choice text="{1001,9913}" section="RMB_choose_kind" comment="choose blueprints"/>
        <add_player_choice text="{1001,12}" section="RBM_show_status" comment="status"/>
        <add_player_choice_return text="{1002,20}" position="bottom_right" comment="back"/>
      </actions>
    </cue>
  </cues>
</mdscript>
